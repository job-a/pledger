package com.github.joba.pledger.controller.userimport com.github.joba.pledger.entity.user.Userimport com.github.joba.pledger.service.user.UserServiceimport org.springframework.security.core.annotation.AuthenticationPrincipalimport org.springframework.security.oauth2.core.oidc.user.OidcUserimport org.springframework.web.bind.annotation.GetMappingimport org.springframework.web.bind.annotation.RequestMappingimport org.springframework.web.bind.annotation.RestController@RestController@RequestMapping("/api/user")class UserController(val userService: UserService) {    val invalidTokenException = Exception("Invalid or missing OIDC token")    @GetMapping    fun findUser(@AuthenticationPrincipal principal: OidcUser?): User {        return userService.verifyOrCreateUser(User(principal?.idToken?.subject ?: throw invalidTokenException, principal?.idToken?.givenName ?: "J. Doe"))    }}